{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import'./Styles/Audio.css';// Импортируйте созданный CSS файл\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AudioPlayer=()=>{const[counter,setCounter]=useState(152);const[header,setHeader]=useState('Loading header...');const[audioCounter,setAudioCounter]=useState(452);const audioRef=useRef(null);useEffect(()=>{loadCounter();},[]);useEffect(()=>{loadAudio(counter);},[counter]);const loadCounter=async()=>{try{const response=await fetch('https://localhost:8080/api/audioCount',{method:'GET'});const count=await response.text();setAudioCounter(Number(count));}catch(error){console.error('Error fetching audio count:',error);}};const loadAudio=async counter=>{const audioUrl=\"https://localhost:8080/api/audio/\".concat(counter);const audioType='audio/mp3';if(audioRef.current){const audioElement=audioRef.current;// Удаляем все текущие source элементы\nwhile(audioElement.firstChild){audioElement.removeChild(audioElement.firstChild);}// Создаем новый элемент source\nconst sourceElement=document.createElement('source');sourceElement.src=audioUrl;sourceElement.type=audioType;// Добавляем новый source элемент в элемент аудио\naudioElement.appendChild(sourceElement);// Устанавливаем название трека (если есть)\ntry{const response=await fetch(\"https://localhost:8080/api/audioName/\".concat(counter),{method:'GET'});setHeader(await response.text());}catch(error){console.error('Error fetching audio name:',error);setHeader('Error loading header');}// Перезагружаем аудио для его воспроизведения с новым источником\naudioElement.load();audioElement.volume=0.1;if(counter!==152){// Воспроизводим аудио, когда оно готово\naudioElement.oncanplaythrough=()=>{audioElement.play().catch(error=>{console.error('Error playing audio:',error);});};};}};const nextAudio=()=>{setCounter(prevCounter=>prevCounter!==audioCounter?prevCounter+50:prevCounter);};const prevAudio=()=>{setCounter(prevCounter=>prevCounter!==152?prevCounter-50:prevCounter);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"audio\",{controls:true,id:\"myAudio\",ref:audioRef,onEnded:nextAudio,children:/*#__PURE__*/_jsx(\"source\",{src:\"\",type:\"audio/mp3\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"V\",id:\"first\",onClick:nextAudio,children:\"\\u0421\\u043B\\u0435\\u0434\\u0443\\u044E\\u0449\\u0438\\u0439\"}),/*#__PURE__*/_jsx(\"button\",{className:\"N\",id:\"second\",onClick:prevAudio,children:\"\\u041F\\u0440\\u0435\\u0434\\u044B\\u0434\\u0443\\u0449\\u0438\\u0439\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-container\",children:/*#__PURE__*/_jsx(\"div\",{id:\"header-value\",children:header})})]});};export default AudioPlayer;","map":{"version":3,"names":["React","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","AudioPlayer","counter","setCounter","header","setHeader","audioCounter","setAudioCounter","audioRef","loadCounter","loadAudio","response","fetch","method","count","text","Number","error","console","audioUrl","concat","audioType","current","audioElement","firstChild","removeChild","sourceElement","document","createElement","src","type","appendChild","load","volume","oncanplaythrough","play","catch","nextAudio","prevCounter","prevAudio","children","controls","id","ref","onEnded","className","onClick"],"sources":["C:/Users/dimu2/Java/SpringSecurity_1805/Frontend/spa/src/Audio.jsx"],"sourcesContent":["import React, {useState, useEffect, useRef} from 'react';\r\nimport './Styles/Audio.css'; // Импортируйте созданный CSS файл\r\n\r\n\r\n\r\nconst AudioPlayer = () => {\r\n  const [counter, setCounter] = useState(152);\r\n  const [header, setHeader] = useState('Loading header...');\r\n  const [audioCounter, setAudioCounter] = useState(452);\r\n  const audioRef = useRef(null);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    loadCounter();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadAudio(counter);\r\n  }, [counter]);\r\n\r\n  const loadCounter = async () => {\r\n    try {\r\n      const response = await fetch('https://localhost:8080/api/audioCount', { method: 'GET' });\r\n      const count = await response.text();\r\n      setAudioCounter(Number(count));\r\n    } catch (error) {\r\n      console.error('Error fetching audio count:', error);\r\n    }\r\n  };\r\n\r\n  const loadAudio = async (counter) => {\r\n    const audioUrl = `https://localhost:8080/api/audio/${counter}`;\r\n    const audioType = 'audio/mp3';\r\n\r\n    if (audioRef.current) {\r\n      const audioElement = audioRef.current;\r\n\r\n      // Удаляем все текущие source элементы\r\n      while (audioElement.firstChild) {\r\n        audioElement.removeChild(audioElement.firstChild);\r\n      }\r\n\r\n      // Создаем новый элемент source\r\n      const sourceElement = document.createElement('source');\r\n      sourceElement.src = audioUrl;\r\n      sourceElement.type = audioType;\r\n\r\n      // Добавляем новый source элемент в элемент аудио\r\n      audioElement.appendChild(sourceElement);\r\n\r\n      // Устанавливаем название трека (если есть)\r\n      try {\r\n        const response = await fetch(`https://localhost:8080/api/audioName/${counter}`, { method: 'GET' });\r\n        setHeader((await response.text()));\r\n      } catch (error) {\r\n        console.error('Error fetching audio name:', error);\r\n        setHeader('Error loading header');\r\n      }\r\n\r\n\r\n      // Перезагружаем аудио для его воспроизведения с новым источником\r\n      audioElement.load();\r\n      audioElement.volume = 0.1;\r\n      if(counter !==152){\r\n      // Воспроизводим аудио, когда оно готово\r\n      audioElement.oncanplaythrough = () => {\r\n        audioElement.play().catch(error => {\r\n          console.error('Error playing audio:', error);\r\n        });\r\n\r\n      }\r\n      };\r\n    }\r\n  };\r\n\r\n  const nextAudio = () => {\r\n    setCounter((prevCounter) => ( prevCounter !== audioCounter ? prevCounter+50 : prevCounter));\r\n  };\r\n\r\n  const prevAudio = () => {\r\n    setCounter((prevCounter) => (prevCounter !== 152 ? prevCounter - 50 : prevCounter));\r\n  };\r\n\r\n\r\n\r\n  return (\r\n      <div>\r\n        <audio controls id=\"myAudio\" ref={audioRef} onEnded={nextAudio}>\r\n          <source src=\"\" type=\"audio/mp3\" />\r\n        </audio>\r\n        <div>\r\n          <button  className=\"V\" id=\"first\" onClick={nextAudio}>Следующий</button>\r\n          <button  className=\"N\" id=\"second\" onClick={prevAudio}>Предыдущий</button>\r\n        </div>\r\n        <div className=\"form-container\">\r\n          <div id=\"header-value\">{header}</div>\r\n        </div>\r\n      </div>\r\n  );\r\n};\r\n\r\nexport default AudioPlayer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}